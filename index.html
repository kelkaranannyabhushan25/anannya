<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vela Flora | Skincare for your Smile</title>
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Elegant Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        sage: '#B2AC88',
                        cream: '#F5F5DC',
                        terracotta: '#E2725B',
                        charcoal: '#2D3436',
                    },
                    fontFamily: {
                        serif: ['Cormorant Garamond', 'serif'],
                        sans: ['Montserrat', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        body { background-color: #F5F5DC; color: #2D3436; scroll-behavior: smooth; }
        .page-view { display: none; }
        .page-view.active { display: block; }
        
        /* Custom Animations */
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .animate-slide { animation: slideIn 0.3s ease-out forwards; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade { animation: fadeIn 0.5s ease-out forwards; }

        /* Hide scrollbar for clean UI */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Product Card Hover Effect */
        .product-card:hover img { transform: scale(1.05); }
        .product-card img { transition: transform 0.6s cubic-bezier(0.165, 0.84, 0.44, 1); }

        /* Loader */
        .loader { border-top-color: #B2AC88; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.13.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.563.0",
    "@google/genai": "https://esm.sh/@google/genai@^1.41.0"
  }
}
</script>
</head>
<body class="font-sans antialiased">

    <!-- Header / Nav -->
    <header class="fixed top-0 w-full z-40 bg-cream/90 backdrop-blur-md border-b border-sage/10 px-6 py-4">
        <nav class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="hidden lg:flex items-center space-x-10 flex-1">
                <a href="#home" class="text-[10px] font-bold uppercase tracking-[0.2em] hover:text-sage transition-colors">Shop</a>
                <a href="#glossary" class="text-[10px] font-bold uppercase tracking-[0.2em] hover:text-sage transition-colors">Glossary</a>
                <a href="#" class="text-[10px] font-bold uppercase tracking-[0.2em] hover:text-sage transition-colors">Journal</a>
            </div>
            
            <a href="#home" class="text-2xl font-black tracking-tighter uppercase text-charcoal">
                VELA<span class="text-sage">FLORA</span>
            </a>

            <div class="flex items-center justify-end space-x-6 flex-1">
                <button onclick="toggleCart(true)" class="relative p-2 hover:bg-sage/5 rounded-full transition-all">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
                    <span id="cart-badge" class="hidden absolute top-0 right-0 w-4 h-4 bg-sage text-white text-[8px] font-bold rounded-full flex items-center justify-center">0</span>
                </button>
            </div>
        </nav>
    </header>

    <!-- Page Content Container -->
    <main class="pt-20">
        
        <!-- HOME PAGE -->
        <div id="home" class="page-view active animate-fade">
            <!-- Hero -->
            <section class="min-h-[85vh] flex flex-col lg:flex-row">
                <div class="w-full lg:w-1/2 flex items-center px-8 lg:px-24 py-20">
                    <div class="max-w-xl">
                        <span class="text-[10px] font-bold text-sage uppercase tracking-[0.3em] mb-6 block">Clean · Plant-Based · Pure</span>
                        <h1 class="text-6xl lg:text-8xl font-serif font-light leading-[0.9] mb-8 text-charcoal">
                            Skincare for your <span class="text-sage italic font-normal">Smile</span>.
                        </h1>
                        <p class="text-lg text-charcoal/60 leading-relaxed mb-12 max-w-md">
                            Formulated with only 10 essential botanical ingredients. Transparent care for the modern minimalist.
                        </p>
                        <a href="#products-list" class="bg-sage text-white px-12 py-5 rounded-full font-bold uppercase tracking-widest text-[10px] shadow-xl shadow-sage/20 hover:scale-105 transition-all inline-block">
                            Explore Collection
                        </a>
                    </div>
                </div>
                <div class="w-full lg:w-1/2 h-[50vh] lg:h-auto relative overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1518531933037-91b2f5f229cc?q=80&w=1200" class="absolute inset-0 w-full h-full object-cover" alt="Dewy botanical leaf">
                </div>
            </section>

            <!-- Product Grid -->
            <section id="products-list" class="py-32 px-6 max-w-7xl mx-auto">
                <div class="text-center mb-24">
                    <h2 class="text-4xl font-serif italic mb-4">Garden Essentials</h2>
                    <p class="text-charcoal/50 text-sm">Crafted for every mood and every moment.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-16" id="home-products">
                    <!-- Products injected by JS -->
                </div>
            </section>
        </div>

        <!-- GLOSSARY PAGE -->
        <div id="glossary" class="page-view animate-fade">
            <section class="py-32 px-6 max-w-4xl mx-auto text-center">
                <h1 class="text-6xl font-serif italic mb-8">The Flora Filter</h1>
                <p class="text-lg text-charcoal/60 mb-16 leading-relaxed">
                    We believe in radical transparency. Every ingredient we use is derived from nature and serves a specific purpose for your skin health.
                </p>
                
                <div class="relative max-w-md mx-auto mb-20">
                    <input type="text" oninput="filterGlossary(this.value)" placeholder="Search ingredients..." class="w-full px-8 py-5 rounded-full bg-white border-none shadow-sm focus:ring-2 focus:ring-sage italic text-sm">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-left" id="glossary-items">
                    <!-- Glossary items injected by JS -->
                </div>
            </section>
        </div>

        <!-- PRODUCT DETAIL PAGE -->
        <div id="product-detail" class="page-view animate-fade">
            <div id="product-detail-content">
                <!-- Detail injected by JS -->
            </div>
        </div>

    </main>

    <!-- Cart Drawer -->
    <div id="cart-drawer" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-charcoal/20 backdrop-blur-sm" onclick="toggleCart(false)"></div>
        <div class="absolute right-0 top-0 bottom-0 w-full max-w-md bg-white shadow-2xl flex flex-col animate-slide">
            <div class="p-8 border-b border-sage/10 flex items-center justify-between">
                <h2 class="text-2xl font-serif italic">Your Flora Cart</h2>
                <button onclick="toggleCart(false)" class="p-2 hover:bg-cream rounded-full">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            
            <div id="cart-items" class="flex-grow overflow-y-auto p-8 space-y-8 no-scrollbar">
                <!-- Cart items injected by JS -->
            </div>

            <div id="cart-footer" class="p-8 border-t border-sage/10 bg-cream/20">
                <div class="flex justify-between items-center mb-8">
                    <span class="text-[10px] font-bold uppercase tracking-widest text-charcoal/50">Subtotal</span>
                    <span id="cart-total" class="text-2xl font-serif italic">$0.00</span>
                </div>
                <button class="w-full bg-terracotta text-white py-5 rounded-2xl font-bold uppercase tracking-widest text-[10px] shadow-xl hover:bg-opacity-90 transition-all">
                    Checkout with One-Click
                </button>
                <p class="text-[8px] text-center mt-6 text-charcoal/40 uppercase tracking-widest">Complimentary Shipping on all orders over $50</p>
            </div>
        </div>
    </div>

    <!-- AI Flora Guide -->
    <div id="ai-assistant" class="fixed bottom-8 right-8 z-50">
        <!-- Floating Button -->
        <button onclick="toggleAI(true)" id="ai-btn" class="w-14 h-14 bg-sage text-white rounded-full flex items-center justify-center shadow-2xl hover:scale-110 transition-all">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/></svg>
        </button>

        <!-- Chat Window -->
        <div id="ai-window" class="hidden absolute bottom-20 right-0 w-[350px] h-[500px] bg-white rounded-[2.5rem] shadow-2xl border border-sage/10 flex flex-col overflow-hidden animate-slide">
            <div class="p-6 bg-cream border-b border-sage/10 flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-sage rounded-full flex items-center justify-center text-white">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a8 8 0 100 16 8 8 0 000-16z"/></svg>
                    </div>
                    <div>
                        <h3 class="text-[10px] font-bold uppercase tracking-widest">Flora Guide</h3>
                        <p class="text-[8px] text-sage font-bold uppercase tracking-[0.1em]">Always Blooming</p>
                    </div>
                </div>
                <button onclick="toggleAI(false)" class="text-charcoal/40 hover:text-charcoal"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg></button>
            </div>
            
            <div id="ai-messages" class="flex-grow p-6 overflow-y-auto space-y-4 no-scrollbar bg-white">
                <div class="flex justify-start">
                    <div class="bg-cream p-4 rounded-2xl rounded-tl-none text-xs leading-relaxed max-w-[85%]">
                        Welcome to the garden. I am your Flora Guide. How can I help you bloom today?
                    </div>
                </div>
            </div>

            <div class="p-4 border-t border-sage/10">
                <form id="ai-form" class="flex items-center space-x-2">
                    <input type="text" id="ai-input" placeholder="Ask about ingredients or order a Dew Stick..." class="flex-grow px-4 py-3 rounded-xl bg-cream/50 text-xs border-none focus:ring-1 focus:ring-sage italic">
                    <button type="submit" class="p-3 bg-sage text-white rounded-xl"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg></button>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripting -->
    <script type="module">
        import { GoogleGenAI, Type } from "@google/genai";

        // APP STATE
        const state = {
            cart: [],
            currentProduct: null,
            ingredients: [
                { name: "Cupuaçu Butter", source: "Amazon Rainforest", function: "Deep Hydration", benefit: "Retains 440% its weight in water for 8h moisture." },
                { name: "Jojoba Oil", source: "Desert Shrub Seeds", function: "Barrier Seal", benefit: "Mimics natural skin oils to prevent moisture loss." },
                { name: "Candelilla Wax", source: "Desert Succulent", function: "Vegan Glide", benefit: "Provides a smooth, protective plant-based texture." },
                { name: "Castor Seed Oil", source: "Botanical Ricinus", function: "Dewy Finish", benefit: "Creates a natural gloss without synthetic polymers." }
            ],
            products: [
                { id: "dew-stick", name: "The Dew Stick", price: 18.00, desc: "Clear hydration for a daily natural glow.", img: "https://images.unsplash.com/photo-1612817288484-6f916006741a?q=80&w=600" },
                { id: "bloom-balm", name: "Bloom Balm", price: 22.00, desc: "A buildable sheer berry tint from hibiscus.", img: "https://images.unsplash.com/photo-1616394584738-fc6e612e71b9?q=80&w=600" },
                { id: "night-mask", name: "The Night Mask", price: 26.00, desc: "Deep overnight repair with wild lavender.", img: "https://images.unsplash.com/photo-1501004318641-b39e6451bec6?q=80&w=600" }
            ]
        };

        // ROUTING
        function navigate() {
            const hash = window.location.hash || '#home';
            document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
            
            if (hash.startsWith('#product/')) {
                const id = hash.split('/')[1];
                renderProductDetail(id);
                document.getElementById('product-detail').classList.add('active');
            } else {
                const target = document.querySelector(hash === '#home' ? '#home' : hash);
                if (target) target.classList.add('active');
            }
        }
        window.onhashchange = navigate;
        window.onload = () => {
            renderHome();
            renderGlossary();
            navigate();
        };

        // UI RENDERING
        function renderHome() {
            const container = document.getElementById('home-products');
            container.innerHTML = state.products.map(p => `
                <div class="product-card group cursor-pointer" onclick="window.location.hash='#product/${p.id}'">
                    <div class="aspect-[4/5] bg-white rounded-[2rem] overflow-hidden mb-8 border border-sage/5 relative">
                        <img src="${p.img}" class="w-full h-full object-cover">
                        <div class="absolute inset-0 bg-charcoal/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                    </div>
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="font-bold uppercase tracking-widest text-xs">${p.name}</h3>
                        <p class="font-serif italic text-sage">$${p.price.toFixed(2)}</p>
                    </div>
                    <p class="text-[10px] text-charcoal/40 uppercase tracking-widest">${p.desc}</p>
                </div>
            `).join('');
        }

        function renderGlossary(filter = '') {
            const container = document.getElementById('glossary-items');
            const items = state.ingredients.filter(i => i.name.toLowerCase().includes(filter.toLowerCase()));
            container.innerHTML = items.map(i => `
                <div class="p-8 bg-white rounded-[2rem] border border-sage/10 hover:shadow-xl transition-all">
                    <h3 class="text-2xl font-serif italic mb-2">${i.name}</h3>
                    <p class="text-[10px] text-sage font-bold uppercase tracking-widest mb-6">${i.function}</p>
                    <div class="space-y-4">
                        <p class="text-xs leading-relaxed text-charcoal/70"><span class="font-bold text-charcoal/40 uppercase tracking-widest mr-2">Source:</span>${i.source}</p>
                        <p class="text-xs leading-relaxed italic text-charcoal/60">"${i.benefit}"</p>
                    </div>
                </div>
            `).join('');
        }
        window.filterGlossary = renderGlossary;

        function renderProductDetail(id) {
            const p = state.products.find(x => x.id === id);
            if (!p) return;
            const container = document.getElementById('product-detail-content');
            container.innerHTML = `
                <div class="max-w-7xl mx-auto px-6 py-12 lg:py-24 grid grid-cols-1 lg:grid-cols-2 gap-20">
                    <div class="aspect-[4/5] bg-white rounded-[3rem] overflow-hidden shadow-2xl">
                        <img src="${p.img}" class="w-full h-full object-cover">
                    </div>
                    <div class="flex flex-col justify-center">
                        <a href="#home" class="text-[10px] font-bold uppercase tracking-widest text-sage mb-10 flex items-center gap-2">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7"/></svg> Back to shop
                        </a>
                        <h1 class="text-6xl font-serif italic mb-6">${p.name}</h1>
                        <p class="text-xl text-charcoal/50 leading-relaxed mb-12">${p.desc}</p>
                        
                        <div class="p-8 bg-white border border-sage/10 rounded-3xl mb-12">
                            <div class="flex items-center justify-between mb-8">
                                <span class="text-xs font-bold uppercase tracking-widest">Pricing</span>
                                <span class="text-3xl font-serif italic text-sage">$${p.price.toFixed(2)}</span>
                            </div>
                            <button onclick="addToCart('${p.id}')" class="w-full bg-terracotta text-white py-6 rounded-2xl font-bold uppercase tracking-widest text-xs shadow-xl hover:scale-[1.02] transition-all">
                                Add to Cart
                            </button>
                        </div>

                        <div class="space-y-6">
                            <details class="group border-b border-sage/10 pb-6" open>
                                <summary class="list-none flex justify-between items-center cursor-pointer font-bold uppercase tracking-widest text-[10px]">
                                    Sustainability Promise <svg class="w-4 h-4 group-open:rotate-180 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7"/></svg>
                                </summary>
                                <p class="text-xs text-charcoal/50 leading-relaxed mt-4">100% Plastic-free. Biodegradable paper tubes. Infinitely recyclable shipping materials.</p>
                            </details>
                        </div>
                    </div>
                </div>
            `;
        }

        // CART LOGIC
        window.addToCart = (id) => {
            const p = state.products.find(x => x.id === id);
            const existing = state.cart.find(x => x.id === id);
            if (existing) existing.qty++;
            else state.cart.push({ ...p, qty: 1 });
            updateCartUI();
            toggleCart(true);
        };

        window.toggleCart = (show) => {
            document.getElementById('cart-drawer').classList.toggle('hidden', !show);
        };

        function updateCartUI() {
            const list = document.getElementById('cart-items');
            const totalEl = document.getElementById('cart-total');
            const badge = document.getElementById('cart-badge');
            
            if (state.cart.length === 0) {
                list.innerHTML = `<div class="h-full flex flex-col items-center justify-center opacity-30 italic">Your garden is empty.</div>`;
                totalEl.innerText = "$0.00";
                badge.classList.add('hidden');
                return;
            }

            let total = 0;
            let count = 0;
            list.innerHTML = state.cart.map(item => {
                total += item.price * item.qty;
                count += item.qty;
                return `
                    <div class="flex gap-6 items-center">
                        <img src="${item.img}" class="w-20 h-20 object-cover rounded-2xl border border-sage/10">
                        <div class="flex-grow">
                            <div class="flex justify-between items-start mb-1">
                                <h4 class="font-bold uppercase tracking-widest text-[10px]">${item.name}</h4>
                                <span class="text-sage font-bold text-xs">$${(item.price * item.qty).toFixed(2)}</span>
                            </div>
                            <p class="text-[10px] text-charcoal/40 uppercase tracking-[0.1em] mb-3">Quantity: ${item.qty}</p>
                            <button onclick="removeFromCart('${item.id}')" class="text-[8px] font-bold uppercase tracking-widest text-terracotta/60 hover:text-terracotta">Remove</button>
                        </div>
                    </div>
                `;
            }).join('');

            totalEl.innerText = `$${total.toFixed(2)}`;
            badge.innerText = count;
            badge.classList.toggle('hidden', count === 0);
        }

        window.removeFromCart = (id) => {
            state.cart = state.cart.filter(x => x.id !== id);
            updateCartUI();
        };

        // AI ASSISTANT LOGIC
        let aiChat = null;
        window.toggleAI = (show) => {
            document.getElementById('ai-window').classList.toggle('hidden', !show);
            if (show && !aiChat) initAI();
        };

        async function initAI() {
            const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });
            const model = 'gemini-3-flash-preview';
            const instruction = `You are the Flora Guide for Vela Flora. Be calm, minimalist, and transactional. 
            Products: 
            - The Dew Stick ($18): Clear everyday hydration.
            - Bloom Balm ($22): Berry sheer tint.
            - The Night Mask ($26): Deep repair.
            
            Actions: 
            - You can add products to cart using the 'add_to_cart' tool.
            - Confirm clearly when an item is added.
            - No asterisks (*). No bolding with stars.
            - Keep responses under 3 sentences. Stay dewy.`;

            aiChat = ai.chats.create({
                model,
                config: {
                    systemInstruction: instruction,
                    tools: [{
                        functionDeclarations: [{
                            name: 'add_to_cart',
                            parameters: {
                                type: Type.OBJECT,
                                properties: { 
                                    productId: { type: Type.STRING, description: "dew-stick, bloom-balm, or night-mask" } 
                                },
                                required: ['productId']
                            }
                        }]
                    }]
                }
            });
        }

        document.getElementById('ai-form').onsubmit = async (e) => {
            e.preventDefault();
            const input = document.getElementById('ai-input');
            const prompt = input.value.trim();
            if (!prompt) return;

            addAIMessage('user', prompt);
            input.value = '';

            try {
                const response = await aiChat.sendMessage({ message: prompt });
                
                if (response.functionCalls) {
                    for (const fc of response.functionCalls) {
                        if (fc.name === 'add_to_cart') {
                            addToCart(fc.args.productId);
                            addAIMessage('model', `I have added that to your essentials. Anything else for your garden?`);
                        }
                    }
                } else {
                    addAIMessage('model', response.text.replace(/\*/g, ''));
                }
            } catch (err) {
                addAIMessage('model', "I had trouble connecting to the roots. Try again later. Stay dewy.");
            }
        };

        function addAIMessage(role, text) {
            const container = document.getElementById('ai-messages');
            const div = document.createElement('div');
            div.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'}`;
            div.innerHTML = `
                <div class="${role === 'user' ? 'bg-sage text-white rounded-tr-none' : 'bg-cream text-charcoal rounded-tl-none'} p-4 rounded-2xl text-xs leading-relaxed max-w-[85%] animate-fade">
                    ${text}
                </div>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

    </script>
</body>
</html>